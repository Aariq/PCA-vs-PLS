---
title: "Drivers of Mourning Cloak Population"
output: html_notebook
---

# Packages
```{r}
library(tidyverse)
library(here)
library(ropls)
library(holodeck)
```

```{r}
# mocl <- read_rds(here::here("data", "mourning-cloaks", "mocl-monthly.rds"))
mocl <- read_rds(here::here("data", "mourning-cloaks", "mocl-seasonal.rds"))
#doesn't matter which one, both are non-significant
```


*Elizabeth's note:*

>I added a response variable of mourning cloak sightings after June 30 because they fly as adults in spring then lay eggs and the 2nd gen flys in fall.  Could also play around with timing of these responses - I thought fall adults would  work well because summer drought was a weak predictor of total sightings


# Fit PCA

```{r}
pca <- opls(select(mocl, -MOCL, -MOCL_fall, -year))
```

```{r}
get_scores(pca) %>% 
  ggplot(aes(x = p1, y = p2, color = mocl$MOCL)) +
  geom_point()
```


```{r}
get_loadings(pca) %>% 
  arrange(desc(abs(p1)))
```

# PLSR

```{r}
plsr <- opls(select(mocl, -MOCL, -MOCL_fall, -year), mocl$MOCL_fall)
```

Nope!
```{r}
plsr <- opls(select(mocl, -MOCL, -MOCL_fall, -year), mocl$MOCL_fall, predI = 1, orthoI = 1)
```

Very bad Q2Y!  Not significant.